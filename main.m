clearvars;
clc;
% x1L=[15,400, 0.40;20,400, 0.42;15,600, 0.30;0,0,0;10,800, 0.35;0,0,0;0,0,0;];
% x1U=[45,1500,0.85;35,1600,0.80;40,1500,0.75;0,0,0;40,1400,0.70;0,0,0;0,0,0;];
% x2L=[18,600, 0.45;20,650, 0.35;25,450, 0.30;20,300, 0.40;15,400, 0.35;0,0,0;25,600, 0.35;];
% x2U=[35,1800,0.80;40,1700,0.85;35,1500,0.80;45,1600,0.78;40,1400,0.75;0,0,0;40,1800,0.85;];
% x3L=[15,600, 0.35;0,0,0;15,600 ,0.35;20,500, 0.40;0,0,0;20,450, 0.45;18,400, 0.40];
% x3U=[35,1500,0.75;0,0,0;40,1300,0.80;30,1800,0.73;0,0,0;38,1600,0.80;35,1700,0.85];
% x4L=[0,0,0;0,0,0;0,0,0;25,500, 0.40;15,400, 0.45;12,500, 0.35;20,600, 0.35];
% x4U=[0,0,0;0,0,0;0,0,0;45,1400,0.75;30,1700,0.70;35,1600,0.80;40,1500,0.78];
% x5L=[21,450, 0.35;0,0,0;0,0,0;20,500, 0.30;25,600, 0.40;0,0,0;0,0,0;];
% x5U=[35,1700,0.75;0,0,0;0,0,0;45,1500,0.75;40,1600,0.70;0,0,0;0,0,0;];

% 56 65 差距0.10 0.10以上  0.046 0.042差距过小
% x1L=[15,700 ,0.70;25,750 ,0.55;20,800 ,0.70;0 ,  0 ,   0;25,900 ,0.65;0 ,  0 ,   0;0 ,0   ,   0;];
% x1U=[30,1200,0.85;40,1300,0.70;35,1400,0.80;0 ,  0 ,   0;55,1600,0.80;0 ,  0 ,   0;0 ,0   ,   0;];
% x2L=[15,850 ,0.70;20,800 ,0.65;20,700 ,0.65;20,600 ,0.65;30,900 ,0.60;0 ,  0 ,   0;25,800 ,0.55;];
% x2U=[30,1400,0.80;40,1600,0.85;35,1400,0.75;40,1200,0.80;55,1700,0.70;0 ,  0 ,   0;50,1600,0.65;];
% x3L=[15,800 ,0.65;0 ,  0 ,   0;20,750 ,0.65;20,700 ,0.70;0 ,  0 ,   0;15,900 ,0.60;25,950 ,0.55;];
% x3U=[30,1500,0.80;0 ,  0 ,   0;35,1500,0.80;35,1400,0.85;0 ,  0 ,   0;35,1600,0.70;50,1700,0.65;];
% x4L=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;20,650 ,0.55;15,550 ,0.70;25,850 ,0.50;25,950 ,0.55;];
% x4U=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,
% 0;45,1300,0.70;35,1200,0.85;50,1600,0.65;45,1800,0.70;];
% 56 65 差距0.10 0.10以上  0.046 0.042差距过小
%专家1增加对方案4的评价数据
% 56 65 有无前景完美
% x1L=[20,800 ,0.60;25,800 ,0.60;20,800 ,0.70;0 ,  0 ,   0;25,850 ,0.65;0 ,  0 ,   0;0 ,0   ,   0;];
% x1U=[35,1500,0.80;35,1600,0.75;40,1400,0.85;0 ,  0 ,   0;40,1600,0.80;0 ,  0 ,   0;0 ,0   ,   0;];
% x2L=[25,700 ,0.70;15,600 ,0.60;20,700 ,0.70;20,600 ,0.70;25,500 ,0.70;0 ,  0 ,   0;20,750 ,0.65;];
% x2U=[40,1400,0.80;35,1500,0.70;35,1400,0.85;40,1300,0.80;45,1300,0.80;0 ,  0 ,   0;35,1500,0.75;];
% x3L=[15,800 ,0.65;0 ,  0 ,   0;20,750 ,0.70;20,700 ,0.70;0 ,  0 ,   0;25,650 ,0.70;20,750 ,0.60;];
% x3U=[30,1600,0.75;0 ,  0 ,   0;35,1600,0.80;35,1400,0.85;0 ,  0 ,   0;40,1600,0.80;40,1400,0.70;];
% x4L=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;20,650 ,0.60;15,700 ,0.70;25,700 ,0.60;15,600 ,0.65;];
% x4U=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;45,1300,0.80;35,1600,0.85;40,1500,0.70;40,1400,0.80;];


% x1L=[20,800 ,0.60;25,700 ,0.60;20,800 ,0.70;0 ,  0 ,   0;25,850 ,0.65;0 ,  0 ,   0;0 ,0   ,   0;];
% x1U=[35,1500,0.80;40,1600,0.75;40,1400,0.85;0 ,  0 ,   0;45,1600,0.70;0 ,  0 ,   0;0 ,0   ,   0;];
% x2L=[25,700 ,0.70;20,500 ,0.60;20,700 ,0.70;20,600 ,0.70;20,900 ,0.60;0 ,  0 ,   0;15,650 ,0.70;];
% x2U=[45,1400,0.80;35,1400,0.70;35,1400,0.85;35,1300,0.85;45,1800,0.70;0 ,  0 ,   0;30,1350,0.85;];
% x3L=[15,800 ,0.65;0 ,  0 ,   0;20,700 ,0.70;20,500 ,0.70;0 ,  0 ,   0;25,500 ,0.80;15,500 ,0.65;];
% x3U=[30,1600,0.75;0 ,  0 ,   0;35,1400,0.80;40,1200,0.85;0 ,  0 ,   0;35,1400,0.85;30,1300,0.80;];
% x4L=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;20,650 ,0.65;15,700 ,0.55;20,600 ,0.75;15,500 ,0.70;];
% x4U=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;35,1300,0.85;35,1600,0.70;30,1500,0.85;35,1300,0.85;];

% x1L=[15,700 ,0.70;25,750 ,0.55;20,800 ,0.60;0 ,  0 ,   0;20,800 ,0.65;0 ,  0 ,   0;0 ,0   ,   0;];
% x1U=[35,1200,0.85;40,1300,0.70;35,1400,0.80;0 ,  0 ,   0;50,1600,0.80;0 ,  0 ,   0;0 ,0   ,   0;];
% x2L=[15,850 ,0.70;20,800 ,0.65;20,700 ,0.65;20,800 ,0.65;25,600 ,0.60;0 ,  0 ,   0;25,800 ,0.55;];
% x2U=[30,1400,0.80;40,1600,0.85;35,1400,0.75;40,1500,0.80;40,1500,0.70;0 ,  0 ,   0;50,1600,0.65;];
% x3L=[15,800 ,0.65;0 ,  0 ,   0;20,750 ,0.65;20,700 ,0.70;0 ,  0 ,   0;15,900 ,0.60;25,950 ,0.55;];
% x3U=[30,1500,0.80;0 ,  0 ,   0;35,1500,0.80;35,1400,0.85;0 ,  0 ,   0;35,1600,0.70;50,1700,0.65;];
% x4L=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;20,650 ,0.55;15,550 ,0.70;25,700 ,0.50;25,950 ,0.55;];
% x4U=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;45,1500,0.70;35,1200,0.85;50,1500,0.65;45,1800,0.70;];

% x1L=[20,800 ,0.60;25,700 ,0.65;20,800 ,0.70;0 ,  0 ,   0;25,800 ,0.65;0 ,  0 ,   0;0 ,0   ,   0;];
% x1U=[35,1500,0.80;40,1600,0.75;40,1400,0.85;0 ,  0 ,   0;45,1500,0.70;0 ,  0 ,   0;0 ,0   ,   0;];
% x2L=[25,700 ,0.70;20,500 ,0.60;20,700 ,0.70;20,500 ,0.70;20,900 ,0.60;0 ,  0 ,   0;15,650 ,0.70;];
% x2U=[45,1400,0.80;35,1400,0.70;35,1400,0.85;35,1300,0.85;45,1800,0.70;0 ,  0 ,   0;30,1350,0.85;];
% x3L=[15,800 ,0.65;0 ,  0 ,   0;20,700 ,0.70;20,500 ,0.70;0 ,  0 ,   0;25,500 ,0.80;15,600 ,0.65;];
% x3U=[30,1600,0.75;0 ,  0 ,   0;35,1400,0.80;40,1200,0.85;0 ,  0 ,   0;35,1400,0.85;30,1350,0.80;];
% x4L=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;20,600 ,0.65;15,700 ,0.55;20,700 ,0.70;15,600 ,0.70;];
% x4U=[0 ,  0 ,   0;0 ,  0 ,   0;0 ,  0 ,   0;35,1300,0.85;35,1600,0.70;30,1600,0.80;35,1300,0.85;];

Max=0.85;deta=-Max*0.02;
X=cat(3,x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);
[sum,paixu]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);
maxFinal=max([abs(sum(1)),abs(sum(2)),abs(sum(3)),abs(sum(4)),abs(sum(5)),abs(sum(6)),abs(sum(7))]);
%% 方案1
%专家1
disp('****************方案1 专家1***************************************************************************');
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x1L(1,3)=x1L(1,3)+deta;x1U(1,3)=x1U(1,3)+deta;
[sum11,paixu11]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(1,3)=x2L(1,3)+deta;x2U(1,3)=x2U(1,3)+deta;
[sum12,paixu12]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家3
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x3L(1,3)=x3L(1,3)+deta;x3U(1,3)=x3U(1,3)+deta;
[sum13,paixu13]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);
%% 方案2
%专家1
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x1L(2,3)=x1L(2,3)+deta;x1U(2,3)=x1U(2,3)+deta;
[sum21,paixu21]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(2,3)=x2L(2,3)+deta;x2U(2,3)=x2U(2,3)+deta;
[sum22,paixu22]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%% 方案3  
%专家1
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x1L(3,3)=x1L(3,3)+deta;x1U(3,3)=x1U(3,3)+deta;
[sum31,paixu31]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(3,3)=x2L(3,3)+deta;x2U(3,3)=x2U(3,3)+deta;
[sum32,paixu32]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家3
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x3L(3,3)=x3L(3,3)+deta;x3U(3,3)=x3U(3,3)+deta;
[sum33,paixu33]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%% 方案4 
%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(4,3)=x2L(4,3)+deta;x2U(4,3)=x2U(4,3)+deta;
[sum42,paixu42]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家3
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x3L(4,3)=x3L(4,3)+deta;x3U(4,3)=x3U(4,3)+deta;
[sum43,paixu43]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家4
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x4L(4,3)=x4L(4,3)+deta;x4U(4,3)=x4U(4,3)+deta;
[sum44,paixu44]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%% 方案5 
%专家1
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x1L(5,3)=x1L(5,3)+deta;x1U(5,3)=x1U(5,3)+deta;
[sum51,paixu51]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(5,3)=x2L(5,3)+deta;x2U(5,3)=x2U(5,3)+deta;
[sum52,paixu52]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家4
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x4L(5,3)=x4L(5,3)+deta;x4U(5,3)=x4U(5,3)+deta;
[sum54,paixu54]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%% 方案6 
%专家3
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x3L(6,3)=x3L(6,3)+deta;x3U(6,3)=x3U(6,3)+deta;
[sum63,paixu63]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家4
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x4L(6,3)=x4L(6,3)+deta;x4U(6,3)=x4U(6,3)+deta;
[sum64,paixu64]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%% 方案7 
%专家2
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x2L(7,3)=x2L(7,3)+deta;x2U(7,3)=x2U(7,3)+deta;
[sum72,paixu72]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家3
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x3L(7,3)=x3L(7,3)+deta;x3U(7,3)=x3U(7,3)+deta;
[sum73,paixu73]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

%专家4
x1L=X(:,:,1);x1U=X(:,:,2);x2L=X(:,:,3);x2U=X(:,:,4);x3L=X(:,:,5);x3U=X(:,:,6);x4L=X(:,:,7);x4U=X(:,:,8);
x4L(7,3)=x4L(7,3)+deta;x4U(7,3)=x4U(7,3)+deta;
[sum74,paixu74]=changeTo5_0306(x1L,x1U,x2L,x2U,x3L,x3U,x4L,x4U);

disp('sum21(2)-sum(2)');disp(sum21(2)-sum(2));
disp('maxFinal');disp(maxFinal);
flag=1;
if(flag==1)
    %方案7
   for i=1:7
        sum72(i)=(sum72(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum73(i)=(sum73(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum74(i)=(sum74(i)-sum(i))/maxFinal;
    end
        %方案6
   for i=1:7
        sum63(i)=(sum63(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum64(i)=(sum64(i)-sum(i))/maxFinal;
    end
        %方案5
   for i=1:7
        sum51(i)=(sum51(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum52(i)=(sum52(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum54(i)=(sum54(i)-sum(i))/maxFinal;
    end
        %方案4
    for i=1:7
        sum44(i)=(sum44(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum43(i)=(sum43(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum42(i)=(sum42(i)-sum(i))/maxFinal;
    end
        %方案3
    for i=1:7
        sum33(i)=(sum33(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum32(i)=(sum32(i)-sum(i))/maxFinal;
    end    
    for i=1:7
        sum31(i)=(sum31(i)-sum(i))/maxFinal;
    end
        %方案2
    for i=1:7
        sum22(i)=(sum22(i)-sum(i))/maxFinal;
    end    
    for i=1:7
        sum21(i)=(sum21(i)-sum(i))/maxFinal;
        
    end
        %方案1
    for i=1:7
        sum13(i)=(sum13(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum12(i)=(sum12(i)-sum(i))/maxFinal;
    end
    for i=1:7
        sum11(i)=(sum11(i)-sum(i))/maxFinal;
    end
end
a=1:7;
scheme0=[sum,paixu;];
%sum11为方案1专家1 sum12为方案1专家2
scheme1=[sum11,paixu11;sum12,paixu12;sum13,paixu13;];
scheme2=[sum21,paixu21;sum22,paixu22;];
scheme3=[sum31,paixu31;sum32,paixu32;sum33,paixu33;];
scheme4=[sum42,paixu42;sum43,paixu43;sum44,paixu44;];
scheme5=[sum51,paixu51;sum52,paixu52;sum54,paixu54;];
scheme6=[sum63,paixu63;sum64,paixu64;];
scheme7=[sum72,paixu72;sum73,paixu73;sum74,paixu74;];
scheme=[scheme0;a,linspace(1,1,7);scheme1;a,linspace(2,2,7);scheme2;a,linspace(3,3,7);scheme3;a,linspace(4,4,7);scheme4;a,linspace(5,5,7);scheme5;a,linspace(6,6,7);scheme6;a,linspace(7,7,7);scheme7];
disp(scheme);


final=[sum11(1),sum12(1),sum13(1),0;
       sum21(2),sum22(2),0,0;
       sum31(3),sum32(3),sum33(3),0;
       0,sum42(4),sum43(4),sum44(4);
       sum51(5),sum52(5),0,sum54(5);
       0,0,sum63(6),sum64(6);
       0,sum72(7),sum73(7),sum74(7);];
disp('final');disp(final);


diff=zeros(1,7);
diff(1)=(abs(sum11(1))+abs(sum12(1))+abs(sum13(1)))/3;
diff(2)=(abs(sum21(2))+abs(sum22(2)))/2;
diff(3)=(abs(sum31(3))+abs(sum32(3))+abs(sum33(3)))/3;
diff(4)=(abs(sum42(4))+abs(sum43(4))+abs(sum44(4)))/3;
diff(5)=(abs(sum51(5))+abs(sum52(5))+abs(sum54(5)))/3;
diff(6)=(abs(sum63(6))+abs(sum64(6)))/2;
diff(7)=(abs(sum72(7))+abs(sum73(7))+abs(sum74(7)))/3;
disp('方案最终前景价值变化量diff');disp(diff);
a2=(diff(2)+diff(6))/2;
a3=(diff(1)+diff(3)+diff(4)+diff(5)+diff(7))/5;
a_avl=(a2+a3)/2;
disp('a2');disp(a2);disp('a3');disp(a3);disp('a_avl');disp(a_avl);

